:root{
  --primary:#db2777; /* Deep Rose/Fuchsia for primary accents */
  --secondary:#f472b6; /* Lighter Rose for secondary use */
  --bg:#fdf2f8; /* Very Light Pink background */
  --card:#ffffff;
  --border:#fbcfe8; /* Light Pink border */
  --muted:#78716c; /* Stone 500 - Muted text */
  --text:#1c1917; /* Stone 900 - Dark text */
  --shadow-color: rgba(219, 39, 119, 0.15); /* Shadow based on primary color */
  --grad-1: #fce7f3; /* Light Mode Gradient Color 1 */
  --grad-2: #fce7f3; /* Light Mode Gradient Color 2 */
}

/* NEW: Dark Mode Variables */
:root.dark-mode {
  --primary: #f472b6; /* Lighter primary in dark mode */
  --secondary: #db2777;
  --bg: #1f2937; /* Gray 800 */
  --card: #374151; /* Gray 700 */
  --border: #4b5563; /* Gray 600 */
  --muted: #9ca3af; /* Gray 400 */
  --text: #f9fafb; /* White/Light Gray */
  --shadow-color: rgba(0, 0, 0, 0.5); 
  
  --grad-1: #374151; /* Dark Mode Gradient Color 1 */
  --grad-2: #1f2937; /* Dark Mode Gradient Color 2 */
}

/* Reset */
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  /* UPDATED: Using variables for background */
  background:
    radial-gradient(1200px 600px at top right, var(--grad-1), transparent),
    radial-gradient(800px 400px at bottom left, var(--grad-2), transparent),
    var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
}

/* SIDEBAR */
.sidebar{
  position:fixed;left:0;top:0;width:240px;height:100vh;
  background:var(--card); /* Solid White / Dark Gray */
  border-right:1px solid var(--border);padding:18px;z-index:50;
  transition:width .28s ease, padding .28s ease, left .3s ease;
  box-shadow: 1px 0 10px rgba(0,0,0,0.05); /* Subtle shadow */
  
  /* FIX 3: ADDED: Flex properties to push footer to the bottom */
  display: flex;
  flex-direction: column;
}
.sidebar.collapsed{
  width:72px;
  padding: 18px 8px; 
}

/* BRAND */
.brand{display:flex;justify-content:space-between;align-items:center;margin-bottom:22px}
/* Updated logo text style */
.logo-text{font-weight:700;color:var(--primary);font-size:20px;display:flex;align-items:center;gap:8px}
.logo-text i{color:var(--primary)}

.sidebar.collapsed .logo-text {
  display: none; /* Hide logo text when collapsed */
}
.sidebar.collapsed .brand {
  justify-content: center;
}
.collapse-btn{background:none;border:none;color:var(--primary);font-size:18px;cursor:pointer}

/* FIX 4: NAV WRAPPER FOR SCROLLING */
.nav-wrapper {
    flex-grow: 1; /* Allows nav-wrapper to take up available space */
    overflow-y: auto; /* Enables scrolling for nav items if content is too long */
    /* Remove default padding from the nav-wrapper so nav items still align with brand/footer */
    padding: 0; 
    margin-bottom: 10px; /* Space above footer */
}

/* NAV */
.nav{list-style:none;padding:0;margin-top:6px}
.nav-item{
  display:flex;align-items:center;gap:12px;
  padding:12px 14px; /* Adjusted padding */
  border-radius:10px; /* Increased rounded corners */
  color:var(--text);cursor:pointer;margin-bottom:8px;position:relative;
  transition:background .25s ease, color .25s ease, transform .25s ease;
  transform:none !important; /* Remove old transform animation */
}
/* New Hover and Active States */
.nav-item i{min-width:20px;color:var(--muted);font-size:16px}
.nav-item span{white-space:nowrap;font-weight:500}
.nav-item:hover{background:#fce7f3;color:var(--text)} /* Light pink hover */
/* Dark mode hover adjustment */
:root.dark-mode .nav-item:hover {
    background: #4b5563; /* Gray 600 hover */
}

.nav-item.active{background:var(--primary);color:var(--card);font-weight:600}
.nav-item.active i{color:var(--card)}

/* Remove old gradient fill animation */
.nav-item::after{display:none;}

/* Sidebar collapsed state for nav items */
.sidebar.collapsed .nav-item {
    justify-content: center;
    padding: 12px 0;
}
.sidebar.collapsed .nav-item span{display:none}


/* NEW SUBMENU STYLES */
.submenu {
    display: none; /* Hidden by default */
    flex-direction: column;
    gap: 4px;
    padding: 0 0 8px 12px; /* Bottom padding and indent */
    margin-top: -4px; /* Move closer to the nav-item above it */
    margin-bottom: 8px;
}

/* When the parent nav-item is active, display the submenu */
.nav-item[data-page="roblox"].active + .submenu,
.nav-item[data-page="ml"].active + .submenu {
    display: flex;
}

/* Style for filter buttons inside the sidebar */
.submenu .btn-filter {
    background: transparent; /* No background */
    color: var(--muted);
    padding: 6px 12px; /* Smaller padding */
    border-radius: 6px;
    border: none;
    text-align: left;
    font-size: 13px; /* Smaller font */
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.submenu .btn-filter:hover {
    background: #fce7f3; /* Light pink hover */
    color: var(--text);
}
:root.dark-mode .submenu .btn-filter:hover {
    background: #4b5563;
}

/* When the filter button is active */
.submenu .btn-filter.active {
    background: var(--secondary); /* Use secondary color for active filter */
    color: var(--card);
    font-weight: 600;
}

/* Hide submenus and filters when sidebar is collapsed */
.sidebar.collapsed .submenu {
  display: none !important;
}
/* END NEW SUBMENU STYLES */


/* MAIN */
.main{
    margin-left:240px;
    padding:24px;
    transition:margin-left .28s ease;
    flex-grow: 1; /* Ensure it takes available space */
    min-height: 100vh;
    box-sizing: border-box; /* IMPORTANT for mobile fix */
} 
/* FIX: New rule to ensure main content shifts correctly when sidebar is collapsed */
body.sidebar-collapsed .main{margin-left:72px}


/* TOPBAR (FIX: ALIGNMENT) */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:var(--card); /* Solid background */
  padding:14px 20px;
  border-radius:12px;
  border:1px solid var(--border);
  margin-bottom:24px;
  /* UPDATED: Box shadow for light and dark mode */
  box-shadow:0 4px 12px rgba(0,0,0,0.04); 
  backdrop-filter:none;
}
:root.dark-mode .topbar {
    box-shadow: 0 4px 12px rgba(0,0,0,0.2); 
}
.top-left{
    display: flex; 
    align-items: center;
    gap: 12px; /* Space between menu toggle and title */
}
.top-left h3{color:var(--primary);margin:0;font-size:1.4rem}
.top-right{
    display:flex;
    align-items:center; /* Vertical alignment fix */
    gap:16px;
}

/* NEW: Mobile Menu Toggle Button (for topbar) */
.menu-toggle-btn {
    display: none; /* Hidden by default on Desktop */
}
/* Topbar Buttons (The menu-toggle-btn uses this class) */
.topbar-btn {
    background: #fce7f3;
    color: var(--text);
    border: 1px solid var(--border);
    padding: 10px 12px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 16px;
    transition: all .2s ease;
}
.topbar-btn:hover {
    background: var(--primary);
    color: var(--card);
    border-color: var(--primary);
}
:root.dark-mode .topbar-btn {
    background: var(--border);
    color: var(--text);
    border-color: var(--muted);
}
:root.dark-mode .topbar-btn:hover {
    background: var(--primary);
    color: var(--card);
    border-color: var(--primary);
}

/* FIX: Control visibility of the topbar Dark Mode toggle */
#mobileDarkModeToggle {
    /* Default visibility is block on mobile (where max-width is met) */
    display: block; 
}
@media (min-width: 901px) {
    /* Hide on desktop, prioritizing the sidebar toggle */
    #mobileDarkModeToggle {
        display: none; 
    }
}


/* FIX: Profile alignment fix */
.profile{
    display:flex;
    align-items:center; /* Vertical alignment fix */
    gap:10px;
    padding:6px 12px;
    background:#fce7f3;
    border-radius:999px;
    cursor: default; /* Not a clickable button */
}
:root.dark-mode .profile {
    background: #4b5563;
}
.profile img{width:36px;height:36px;border-radius:50%}
.profile-name{font-weight:500}


/* PAGES */
.page{display:none;animation:pageIn .45s ease}
.page.active{display:block}
@keyframes pageIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

/* SECTION (cards) */
section{background:var(--card);border-radius:16px;padding:24px;
  box-shadow:0 8px 20px var(--shadow-color); /* Use new shadow variable */
  margin-bottom: 24px;
}
section h2{color:var(--primary);margin-bottom:4px}
.muted{color:var(--muted);margin-top:6px;margin-bottom:16px;font-size:0.95rem}

/* STAT CARDS - Enhanced visual separation */
.cards{display:flex;gap:20px;margin-top:20px}
.card{flex:1;padding:20px;border-radius:12px;
  background:#fff;border:1px solid var(--border);
  box-shadow:0 4px 10px rgba(0,0,0,.03);
  display:flex;align-items:center;gap:16px;
}
/* Dark mode card adjustment */
:root.dark-mode .card {
    background: #4b5563; 
    border-color: #374151;
}
.card i{font-size:2rem;color:var(--primary)}
.card h4{font-size:1rem;color:var(--muted);margin-bottom:4px;font-weight:500}
.card p{font-size:24px;font-weight:700;color:var(--text)}

/* Card Colors - Adding variety */
.card:nth-child(1) i{color:#fb923c} /* Orange */
.card:nth-child(2) i{color:#facc15} /* Yellow */
.card:nth-child(3) i{color:#34d399} /* Green */

/* Dark mode icon colors (slightly adjusted) */
:root.dark-mode .card:nth-child(1) i{color:#fdb86c} 
:root.dark-mode .card:nth-child(2) i{color:#fde047}
:root.dark-mode .card:nth-child(3) i{color:#6ee7b7}


/* FORM */
.form-row{display:flex;gap:20px;align-items:end;margin-bottom:16px}
.form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-top:16px}
label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px;font-weight:500}
input,select{width:100%;padding:10px 12px;border-radius:8px;border:1px solid var(--border);background:var(--card);
  font-size:15px;color:var(--text)}
input:focus,select:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(219, 39, 119, 0.1)}

/* Dark mode form focus shadow */
:root.dark-mode input:focus, :root.dark-mode select:focus{
    box-shadow:0 0 0 3px rgba(244, 114, 182, 0.4);
}

.btn-primary{background:var(--primary);color:#fff;padding:10px 16px;border-radius:8px;border:none;cursor:pointer;
  font-weight:600;display:inline-flex;align-items:center;gap:8px;transition:all .2s ease}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 10px rgba(219, 39, 119, 0.4)}
.btn-primary:disabled{opacity:0.6; cursor: not-allowed; box-shadow: none; transform: none;}

/* Data Table Container for horizontal scrolling */
/* IMPORTANT FIX: Adding overflow-x: auto for mobile tables */
.table-container {
    width: 100%;
    overflow-x: auto; /* Enable horizontal scrolling for tables */
}
.data-table{
  width:100%;border-collapse:separate;border-spacing:0;margin-top:16px;
  min-width: 900px; /* Forces horizontal scroll on smaller screen widths */
}
.data-table thead th{
  font-size:12px;text-align:left;color:var(--muted);
  padding:12px 14px;background:#f8fafc;
  border-bottom:2px solid var(--border);
  text-transform:uppercase;font-weight:600;letter-spacing:0.05em;
}
/* Dark mode table header */
:root.dark-mode .data-table thead th {
    background: #374151;
}

.data-table tbody tr{
  background:var(--card);
  transition:box-shadow .2s ease;
}
/* Dark mode table row hover */
.data-table tbody tr:hover{box-shadow:0 6px 15px rgba(0,0,0,.06)}
:root.dark-mode .data-table tbody tr:hover{box-shadow:0 6px 15px rgba(0,0,0,.15)}

.data-table td{padding:12px 14px;border-bottom:1px solid var(--border);font-size:14px;}
.data-table tbody tr:last-child td{border-bottom:none;}
.data-table td button{background:none;border:none;cursor:pointer;font-size:16px; color:var(--muted)}
:root.dark-mode .data-table td button { color: var(--text); }


/* STATUS BADGES - Updated to be more visually distinct */
.UNPENDING, .PROCESSING, .DELAYED, .DONE, .CANCELLED {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  min-width: 90px;
  text-align: center;
}
/* Light Mode Colors */
.UNPENDING{background:#fffbe0;color:#d97706;}
.PROCESSING{background:#dbeafe;color:#2563eb;}
.DELAYED{background:#fee2e2;color:#ef4444;}
.DONE{background:#ecfdf5;color:#10b981;}
.CANCELLED{background:#f3f4f6;color:#6b7280;}

/* Dark Mode Color Overrides for Badges */
:root.dark-mode .UNPENDING{background:#4b3f00;color:#facc15;}
:root.dark-mode .PROCESSING{background:#1e40af;color:#93c5fd;}
:root.dark-mode .DELAYED{background:#7f1d1d;color:#f87171;}
:root.dark-mode .DONE{background:#065f46;color:#6ee7b7;}
:root.dark-mode .CANCELLED{background:#4b5563;color:#d1d5db;}

/* MODAL FIX: Ensuring action buttons are visible */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:100}
.modal-content{
  background:var(--card);
  padding:24px;border-radius:12px;
  width:400px; 
  max-height: 90vh; 
  overflow-y: auto; 
  box-shadow:0 25px 50px rgba(0,0,0,.25);
  display: flex; flex-direction: column; gap: 12px;
}
.modal-content h3{margin-bottom:8px;color:var(--primary)}
.modal-actions{display:flex;gap:10px;margin-top:20px;justify-content:flex-end}
.btn-danger{background:#fecaca;color:#ef4444;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:600;transition:background .2s}
.btn-danger:hover{background:#fca5a5;color:#dc2626}
:root.dark-mode .btn-danger{background:#7f1d1d;color:#f87171;}
:root.dark-mode .btn-danger:hover{background:#991b1b;color:#fecaca;}

.btn-ghost{background:transparent;border:1px solid var(--border);padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:500;transition:background .2s}
.btn-ghost:hover{background:#f1f5f9}
:root.dark-mode .btn-ghost:hover{background:#4b5563}


/* TOAST */
#toast{position:fixed;right:20px;bottom:20px;padding:12px 18px;border-radius:10px;
  background:var(--primary);color:#fff;display:none;font-weight:500;
  box-shadow:0 6px 15px rgba(219, 39, 119, 0.4);
  z-index:110;
}

/* small */
.hidden{display:none}


/* ========================================================== */
/* SIDEBAR FOOTER ACTIONS */
/* ========================================================== */
.sidebar-footer-actions {
    /* Pushes the element to the bottom of the flex container (sidebar) */
    margin-top: auto; 
    padding-top: 20px;
    border-top: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    gap: 10px;
    /* FIX 3: Add flex-shrink to ensure it doesn't try to shrink */
    flex-shrink: 0; 
}
.sidebar-footer-actions button {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
    padding: 10px 14px;
    font-size: 14px;
    font-weight: 500;
    justify-content: flex-start; /* Ensure text aligns left when expanded */
}
/* Dark Mode Toggle Visuals in sidebar */
.sidebar-footer-actions .btn-ghost {
    background: transparent;
    border-color: transparent;
    color: var(--text);
}
.sidebar-footer-actions .btn-ghost:hover {
    background: #fce7f3;
    color: var(--text);
}
:root.dark-mode .sidebar-footer-actions .btn-ghost:hover {
    background: #4b5563;
}
/* Sign Out Button Visuals in sidebar */
.sidebar-footer-actions .btn-danger {
    /* Re-styling the danger button to be less intrusive in the sidebar */
    background: transparent;
    color: #ef4444; 
    border: 1px solid transparent; 
    font-weight: 500;
}
.sidebar-footer-actions .btn-danger:hover {
    background: #fee2e2;
    border-color: #fecaca;
}
:root.dark-mode .sidebar-footer-actions .btn-danger:hover {
    background: #7f1d1d;
    border-color: #7f1d1d;
    color: #f87171;
}

/* COLLAPSED SIDEBAR STATES for Footer Actions (Desktop View) */
.sidebar.collapsed .sidebar-footer-actions {
    align-items: center; /* Center icons */
    gap: 4px;
}
.sidebar.collapsed .sidebar-footer-actions button {
    justify-content: center;
    width: 100%; /* Full width for the button element */
    padding: 12px 0; /* Vertical space only */
}
.sidebar.collapsed .sidebar-footer-actions button span {
    display: none; /* Hide button text when collapsed */
}
.sidebar.collapsed .sidebar-footer-actions {
    padding-top: 10px;
    border-top: none; /* Remove border when collapsed */
}


/* ========================================================== */
/* MOBILE RESPONSIVENESS FIXES (900px and below) */
/* ========================================================== */

/* Mobile Nav Container (Hidden by default on Desktop) */
#mobile-nav {
    display: none; 
}

@media (max-width: 900px) {
    
    /* SIDEBAR AS MOBILE MENU */
   /* SIDEBAR AS MOBILE MENU */
    .sidebar {
        /* Default state: hidden off-screen */
        left: -240px; 
        /* Ensure it's full-height over the main content */
        z-index: 100; 
        transition: left .3s ease; /* Ensure transition works */
    }

    /* NEW: Class to show the mobile sidebar */
    .sidebar.mobile-open {
        left: 0;
    }
    
    /* NEW: When the mobile sidebar is open, it should NOT be collapsed. */
    .sidebar.mobile-open.collapsed {
        width: 240px; /* Reset width to expanded size */
        padding: 18px; /* Reset padding to expanded size */
    }
    
    /* MAIN CONTENT */
    /* FIX: When the mobile sidebar is open, the main content is dimmed/not shifted */
    .main, 
    /* Remove body.sidebar-collapsed .main on mobile */
    .main, body.sidebar-collapsed .main {
        margin-left: 0; 
        /* UPDATED: Increased bottom padding to prevent content from being hidden by the bottom nav */
        padding: 16px 16px 80px 16px; 
    }
    
    /* NEW: Show the mobile menu toggle button */
    .menu-toggle-btn {
        display: block; 
    }
    
    /* FIX: Hide profile name on mobile */
    .profile-name {
        display: none;
    }

    /* FIX: Make STAT CARDS stackable or scrollable on mobile */
    .cards {
        flex-direction: column; /* Stack the cards vertically */
        gap: 16px;
    }
    .card {
        flex: none; /* Remove flex: 1 behavior */
        width: 100%;
    }

    /* FIX: Ensure table container scrolls on mobile */
    .table-container {
        /* This is the key fix for horizontal alignment/overflow */
        overflow-x: auto;
    }

    /* FIX: Prevent form grid from overflowing by making it vertical on mobile */
    .form-grid {
        grid-template-columns: 1fr;
    }
    .form-row {
        flex-direction: column;
        gap: 16px;
        align-items: stretch;
    }
    .form-row > div {
        width: 100% !important; /* Force full width */
    }

    /* NEW: MOBILE BOTTOM NAVIGATION BAR */
    #mobile-nav {
        display: flex;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: 65px; /* Height of the bar */
        background: var(--card);
        border-top: 1px solid var(--border);
        box-shadow: 0 -4px 10px rgba(0,0,0,0.05); /* Top shadow only */
        justify-content: space-around;
        align-items: center;
        padding: 0 5px;
        z-index: 60;
    }
    
    .mobile-nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        flex: 1;
        text-decoration: none;
        color: var(--muted);
        font-size: 0.75rem; /* Smaller font for labels */
        font-weight: 500;
        height: 100%;
        transition: color 0.2s ease;
    }
    
    .mobile-nav-item i {
        font-size: 1.3rem;
        margin-bottom: 2px;
    }
    
    .mobile-nav-item.active {
        color: var(--primary); /* Use light/dark pink for the active item */
    }
    
    /* Dark Mode adjustment for shadow */
    :root.dark-mode #mobile-nav {
        box-shadow: 0 -4px 10px rgba(0,0,0,0.25);
    }
}